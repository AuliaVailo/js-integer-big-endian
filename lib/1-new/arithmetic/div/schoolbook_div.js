'use strict';

Object.defineProperty(exports, "__esModule", {
	value: true
});
exports.schoolbook_div = schoolbook_div;

var _array = require('../../array');

var _mul = require('../mul');

var _ = require('.');

/**
 * Computes q <- a / b and a <- a % b.
 * No leading zeros allowed.
 * q has length at least qi + aj - ai
 */
function schoolbook_div(r, a, ai, aj, b, bi, bj, q, qi) {

	var _r = Math.ceil(r / 2);
	var x = b[bi];

	if (x < _r) {

		// we need x to be >= _r so we multiply b by ceil( _r / x )
		// this gives us <= ( 1 + _r / x ) b < r^(bj-bi)
		// (this can be implemented faster using bit shifts if r = 2^k )
		var z = Math.ceil(_r / x);
		var m = aj - ai + 1;
		var n = bj - bi;

		var _a = (0, _array._zeros)(m);
		(0, _mul._mul_limb)(r, z, a, ai, aj, _a, 0, m);

		var _b = (0, _array._zeros)(n);
		(0, _mul._mul_limb)(r, z, b, bi, bj, _b, 0, n);

		var _q = (0, _array._zeros)(m);

		(0, _._schoolbook_div)(r, _a, 0, m, _b, 0, n, _q, 0);
		(0, _._div_limb_partial_fast)(r, _a[0], z, _a, 1, m, a, ai);
		(0, _array._copy)(_q, 1, m, q, qi);
		return;
	}

	return (0, _._schoolbook_div)(r, a, ai, aj, b, bi, bj, q, qi);
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy8xLW5ldy9hcml0aG1ldGljL2Rpdi9zY2hvb2xib29rX2Rpdi5qcyJdLCJuYW1lcyI6WyJzY2hvb2xib29rX2RpdiIsInIiLCJhIiwiYWkiLCJhaiIsImIiLCJiaSIsImJqIiwicSIsInFpIiwiX3IiLCJNYXRoIiwiY2VpbCIsIngiLCJ6IiwibSIsIm4iLCJfYSIsIl9iIiwiX3EiXSwibWFwcGluZ3MiOiI7Ozs7O1FBU2dCQSxjLEdBQUFBLGM7O0FBVGhCOztBQUNBOztBQUNBOztBQUVBOzs7OztBQUtPLFNBQVNBLGNBQVQsQ0FBMEJDLENBQTFCLEVBQThCQyxDQUE5QixFQUFrQ0MsRUFBbEMsRUFBdUNDLEVBQXZDLEVBQTRDQyxDQUE1QyxFQUFnREMsRUFBaEQsRUFBcURDLEVBQXJELEVBQTBEQyxDQUExRCxFQUE4REMsRUFBOUQsRUFBbUU7O0FBRXpFLEtBQU1DLEtBQUtDLEtBQUtDLElBQUwsQ0FBV1gsSUFBSSxDQUFmLENBQVg7QUFDQSxLQUFNWSxJQUFJUixFQUFFQyxFQUFGLENBQVY7O0FBRUEsS0FBS08sSUFBSUgsRUFBVCxFQUFjOztBQUViO0FBQ0E7QUFDQTtBQUNBLE1BQU1JLElBQUlILEtBQUtDLElBQUwsQ0FBV0YsS0FBS0csQ0FBaEIsQ0FBVjtBQUNBLE1BQU1FLElBQUlYLEtBQUtELEVBQUwsR0FBVSxDQUFwQjtBQUNBLE1BQU1hLElBQUlULEtBQUtELEVBQWY7O0FBRUEsTUFBTVcsS0FBSyxtQkFBUUYsQ0FBUixDQUFYO0FBQ0Esc0JBQVdkLENBQVgsRUFBZWEsQ0FBZixFQUFtQlosQ0FBbkIsRUFBdUJDLEVBQXZCLEVBQTRCQyxFQUE1QixFQUFpQ2EsRUFBakMsRUFBc0MsQ0FBdEMsRUFBMENGLENBQTFDOztBQUVBLE1BQU1HLEtBQUssbUJBQVFGLENBQVIsQ0FBWDtBQUNBLHNCQUFXZixDQUFYLEVBQWVhLENBQWYsRUFBbUJULENBQW5CLEVBQXVCQyxFQUF2QixFQUE0QkMsRUFBNUIsRUFBaUNXLEVBQWpDLEVBQXNDLENBQXRDLEVBQTBDRixDQUExQzs7QUFFQSxNQUFNRyxLQUFLLG1CQUFRSixDQUFSLENBQVg7O0FBRUEseUJBQWlCZCxDQUFqQixFQUFxQmdCLEVBQXJCLEVBQTBCLENBQTFCLEVBQThCRixDQUE5QixFQUFrQ0csRUFBbEMsRUFBdUMsQ0FBdkMsRUFBMkNGLENBQTNDLEVBQStDRyxFQUEvQyxFQUFvRCxDQUFwRDtBQUNBLGdDQUF3QmxCLENBQXhCLEVBQTRCZ0IsR0FBRyxDQUFILENBQTVCLEVBQW9DSCxDQUFwQyxFQUF3Q0csRUFBeEMsRUFBNkMsQ0FBN0MsRUFBaURGLENBQWpELEVBQXFEYixDQUFyRCxFQUF5REMsRUFBekQ7QUFDQSxvQkFBT2dCLEVBQVAsRUFBWSxDQUFaLEVBQWdCSixDQUFoQixFQUFvQlAsQ0FBcEIsRUFBd0JDLEVBQXhCO0FBQ0E7QUFFQTs7QUFFRCxRQUFPLHVCQUFpQlIsQ0FBakIsRUFBcUJDLENBQXJCLEVBQXlCQyxFQUF6QixFQUE4QkMsRUFBOUIsRUFBbUNDLENBQW5DLEVBQXVDQyxFQUF2QyxFQUE0Q0MsRUFBNUMsRUFBaURDLENBQWpELEVBQXFEQyxFQUFyRCxDQUFQO0FBRUEiLCJmaWxlIjoic2Nob29sYm9va19kaXYuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBfemVyb3MgLCBfY29weSB9IGZyb20gJy4uLy4uL2FycmF5JyA7XG5pbXBvcnQgeyBfbXVsX2xpbWIgfSBmcm9tICcuLi9tdWwnIDtcbmltcG9ydCB7IF9zY2hvb2xib29rX2RpdiAsIF9kaXZfbGltYl9wYXJ0aWFsX2Zhc3QgfSBmcm9tICcuJyA7XG5cbi8qKlxuICogQ29tcHV0ZXMgcSA8LSBhIC8gYiBhbmQgYSA8LSBhICUgYi5cbiAqIE5vIGxlYWRpbmcgemVyb3MgYWxsb3dlZC5cbiAqIHEgaGFzIGxlbmd0aCBhdCBsZWFzdCBxaSArIGFqIC0gYWlcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHNjaG9vbGJvb2tfZGl2ICggciAsIGEgLCBhaSAsIGFqICwgYiAsIGJpICwgYmogLCBxICwgcWkgKSB7XG5cblx0Y29uc3QgX3IgPSBNYXRoLmNlaWwoIHIgLyAyICkgO1xuXHRjb25zdCB4ID0gYltiaV0gO1xuXG5cdGlmICggeCA8IF9yICkge1xuXG5cdFx0Ly8gd2UgbmVlZCB4IHRvIGJlID49IF9yIHNvIHdlIG11bHRpcGx5IGIgYnkgY2VpbCggX3IgLyB4IClcblx0XHQvLyB0aGlzIGdpdmVzIHVzIDw9ICggMSArIF9yIC8geCApIGIgPCByXihiai1iaSlcblx0XHQvLyAodGhpcyBjYW4gYmUgaW1wbGVtZW50ZWQgZmFzdGVyIHVzaW5nIGJpdCBzaGlmdHMgaWYgciA9IDJeayApXG5cdFx0Y29uc3QgeiA9IE1hdGguY2VpbCggX3IgLyB4ICkgO1xuXHRcdGNvbnN0IG0gPSBhaiAtIGFpICsgMSA7XG5cdFx0Y29uc3QgbiA9IGJqIC0gYmkgO1xuXG5cdFx0Y29uc3QgX2EgPSBfemVyb3MoIG0gKSA7XG5cdFx0X211bF9saW1iKCByICwgeiAsIGEgLCBhaSAsIGFqICwgX2EgLCAwICwgbSApIDtcblxuXHRcdGNvbnN0IF9iID0gX3plcm9zKCBuICkgO1xuXHRcdF9tdWxfbGltYiggciAsIHogLCBiICwgYmkgLCBiaiAsIF9iICwgMCAsIG4gKSA7XG5cblx0XHRjb25zdCBfcSA9IF96ZXJvcyggbSApIDtcblxuXHRcdF9zY2hvb2xib29rX2RpdiggciAsIF9hICwgMCAsIG0gLCBfYiAsIDAgLCBuICwgX3EgLCAwICkgO1xuXHRcdF9kaXZfbGltYl9wYXJ0aWFsX2Zhc3QoIHIgLCBfYVswXSAsIHogLCBfYSAsIDEgLCBtICwgYSAsIGFpICkgO1xuXHRcdF9jb3B5KCBfcSAsIDEgLCBtICwgcSAsIHFpICkgO1xuXHRcdHJldHVybiA7XG5cblx0fVxuXG5cdHJldHVybiBfc2Nob29sYm9va19kaXYoIHIgLCBhICwgYWkgLCBhaiAsIGIgLCBiaSAsIGJqICwgcSAsIHFpICkgO1xuXG59XG4iXX0=