'use strict';

Object.defineProperty(exports, "__esModule", {
	value: true
});
exports._dc_div_32 = _dc_div_32;

var _array = require('../../array');

var _sub = require('../sub');

var _compare = require('../../compare');

var _add = require('../add');

var _api = require('../../../api');

var _ = require('.');

/**
 * Algorithm 3.4 Divide-and-conquer division (3 by 2)
 * ==================================================
 *
 * Input
 * -----
 *  Two nonnegative integers A and B,
 *  such that A < β^n B and β^{2n} / 2 ≤ B < β^{2n}.
 *  n must be even.
 *
 *                    --------                 -----
 *                   |  |  |  |               |  |  |
 *                    --------                 -----
 *
 * Output
 * ------
 *  The quotient floor( A/B ) and the remainder A mod B.
 *
 * Complexity
 * ----------
 *  T'(n) ≤ T(n) + M(n) + Ln
 *
 */
function _dc_div_32(r, a, ai, aj, b, bi, bj, c, ci, cj) {

	// 1. Let A = A_2 β^{2n} + A_1 β^n + A_0 and
	//    B = B_1 β^{n} + B_0,
	//    with 0 ≤ A_i < β^n and 0 ≤ B_i < β^n.

	var k = bj - bi;
	var n = k >>> 1;

	// 2. If A_2 < B_1, compute Q = floor( ( A_2 β^n + A_1 ) / B_1 ) with
	//    remainder R_1 using algorithm 3.3;

	if ((0, _compare._lt)(a, ai, ai + n, b, bi, bi + n)) {
		(0, _._dc_div_21)(r, a, ai, aj - n, b, bi, bi + n, c, ci + n, cj);
	}

	//    otherwise let Q = β^n - 1, and R_1 = ( A_2 - B_1 ) β^n + A_1 + B_1
	//    (note in this case that A_2 = B_1)

	else {
			(0, _array._fill)(c, cj - n, cj, r - 1);
			(0, _add._iadd)(r, a, ai, aj - n, b, bi, bi + n);
			(0, _sub._isub)(r, a, ai, ai + n, b, bi, bi + n);
		}

	// 3. R <- R_1 β^n + A_0 - Q*B_0

	var zi = 0;
	var zj = n << 1;
	var z = (0, _array._zeros)(zj);
	(0, _api._mul)(r, c, cj - n, cj, b, bi + n, bj, z, zi, zj);
	(0, _sub._isub)(r, a, ai, aj, z, zi, zj);

	// 4. if R < 0 , R <- R + B and Q <- Q - 1

	if (a[ai] === 0) return;
	(0, _add._iadd)(r, a, ai, aj, b, bi, bj);
	(0, _sub._decrement)(r, c, cj - n, cj);

	// 5. if R < 0 , R <- R + B and Q <- Q - 1

	if (a[ai] === 0) return;
	(0, _add._iadd)(r, a, ai, aj, b, bi, bj);
	(0, _sub._decrement)(r, c, cj - n, cj);

	// 6. Return Q and R
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9jb3JlL2FyaXRobWV0aWMvZGl2L19kY19kaXZfMzIuanMiXSwibmFtZXMiOlsiX2RjX2Rpdl8zMiIsInIiLCJhIiwiYWkiLCJhaiIsImIiLCJiaSIsImJqIiwiYyIsImNpIiwiY2oiLCJrIiwibiIsInppIiwiemoiLCJ6Il0sIm1hcHBpbmdzIjoiOzs7OztRQThCZ0JBLFUsR0FBQUEsVTs7QUE5QmhCOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUVBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQXVCTyxTQUFTQSxVQUFULENBQXNCQyxDQUF0QixFQUEwQkMsQ0FBMUIsRUFBOEJDLEVBQTlCLEVBQW1DQyxFQUFuQyxFQUF3Q0MsQ0FBeEMsRUFBNENDLEVBQTVDLEVBQWlEQyxFQUFqRCxFQUFzREMsQ0FBdEQsRUFBMERDLEVBQTFELEVBQStEQyxFQUEvRCxFQUFvRTs7QUFFMUU7QUFDQTtBQUNBOztBQUVBLEtBQU1DLElBQUlKLEtBQUtELEVBQWY7QUFDQSxLQUFNTSxJQUFJRCxNQUFNLENBQWhCOztBQUVBO0FBQ0E7O0FBRUEsS0FBSyxrQkFBS1QsQ0FBTCxFQUFTQyxFQUFULEVBQWNBLEtBQUtTLENBQW5CLEVBQXVCUCxDQUF2QixFQUEyQkMsRUFBM0IsRUFBZ0NBLEtBQUtNLENBQXJDLENBQUwsRUFBZ0Q7QUFDL0Msb0JBQVlYLENBQVosRUFBZ0JDLENBQWhCLEVBQW9CQyxFQUFwQixFQUF5QkMsS0FBS1EsQ0FBOUIsRUFBa0NQLENBQWxDLEVBQXNDQyxFQUF0QyxFQUEyQ0EsS0FBS00sQ0FBaEQsRUFBb0RKLENBQXBELEVBQXdEQyxLQUFLRyxDQUE3RCxFQUFpRUYsRUFBakU7QUFDQTs7QUFFRDtBQUNBOztBQUxBLE1BT0s7QUFDSixxQkFBT0YsQ0FBUCxFQUFXRSxLQUFLRSxDQUFoQixFQUFvQkYsRUFBcEIsRUFBeUJULElBQUksQ0FBN0I7QUFDQSxtQkFBT0EsQ0FBUCxFQUFXQyxDQUFYLEVBQWVDLEVBQWYsRUFBb0JDLEtBQUtRLENBQXpCLEVBQTZCUCxDQUE3QixFQUFpQ0MsRUFBakMsRUFBc0NBLEtBQUtNLENBQTNDO0FBQ0EsbUJBQU9YLENBQVAsRUFBV0MsQ0FBWCxFQUFlQyxFQUFmLEVBQW9CQSxLQUFLUyxDQUF6QixFQUE2QlAsQ0FBN0IsRUFBaUNDLEVBQWpDLEVBQXNDQSxLQUFLTSxDQUEzQztBQUNBOztBQUVEOztBQUVBLEtBQU1DLEtBQUssQ0FBWDtBQUNBLEtBQU1DLEtBQUtGLEtBQUssQ0FBaEI7QUFDQSxLQUFNRyxJQUFJLG1CQUFRRCxFQUFSLENBQVY7QUFDQSxnQkFBTWIsQ0FBTixFQUFVTyxDQUFWLEVBQWNFLEtBQUtFLENBQW5CLEVBQXVCRixFQUF2QixFQUE0QkwsQ0FBNUIsRUFBZ0NDLEtBQUtNLENBQXJDLEVBQXlDTCxFQUF6QyxFQUE4Q1EsQ0FBOUMsRUFBa0RGLEVBQWxELEVBQXVEQyxFQUF2RDtBQUNBLGlCQUFPYixDQUFQLEVBQVdDLENBQVgsRUFBZUMsRUFBZixFQUFvQkMsRUFBcEIsRUFBeUJXLENBQXpCLEVBQTZCRixFQUE3QixFQUFrQ0MsRUFBbEM7O0FBRUE7O0FBRUEsS0FBS1osRUFBRUMsRUFBRixNQUFVLENBQWYsRUFBbUI7QUFDbkIsaUJBQU9GLENBQVAsRUFBV0MsQ0FBWCxFQUFlQyxFQUFmLEVBQW9CQyxFQUFwQixFQUF5QkMsQ0FBekIsRUFBNkJDLEVBQTdCLEVBQWtDQyxFQUFsQztBQUNBLHNCQUFZTixDQUFaLEVBQWdCTyxDQUFoQixFQUFvQkUsS0FBS0UsQ0FBekIsRUFBNkJGLEVBQTdCOztBQUVBOztBQUVBLEtBQUtSLEVBQUVDLEVBQUYsTUFBVSxDQUFmLEVBQW1CO0FBQ25CLGlCQUFPRixDQUFQLEVBQVdDLENBQVgsRUFBZUMsRUFBZixFQUFvQkMsRUFBcEIsRUFBeUJDLENBQXpCLEVBQTZCQyxFQUE3QixFQUFrQ0MsRUFBbEM7QUFDQSxzQkFBWU4sQ0FBWixFQUFnQk8sQ0FBaEIsRUFBb0JFLEtBQUtFLENBQXpCLEVBQTZCRixFQUE3Qjs7QUFFQTtBQUVBIiwiZmlsZSI6Il9kY19kaXZfMzIuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBfemVyb3MgLCBfZmlsbCB9IGZyb20gJy4uLy4uL2FycmF5JyA7XG5pbXBvcnQgeyBfZGVjcmVtZW50ICwgX2lzdWIgfSBmcm9tICcuLi9zdWInIDtcbmltcG9ydCB7IF9sdCB9IGZyb20gJy4uLy4uL2NvbXBhcmUnIDtcbmltcG9ydCB7IF9pYWRkIH0gZnJvbSAnLi4vYWRkJyA7XG5pbXBvcnQgeyBfbXVsIH0gZnJvbSAnLi4vLi4vLi4vYXBpJyA7XG5pbXBvcnQgeyBfZGNfZGl2XzIxIH0gZnJvbSAnLicgO1xuXG4vKipcbiAqIEFsZ29yaXRobSAzLjQgRGl2aWRlLWFuZC1jb25xdWVyIGRpdmlzaW9uICgzIGJ5IDIpXG4gKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICpcbiAqIElucHV0XG4gKiAtLS0tLVxuICogIFR3byBub25uZWdhdGl2ZSBpbnRlZ2VycyBBIGFuZCBCLFxuICogIHN1Y2ggdGhhdCBBIDwgzrJebiBCIGFuZCDOsl57Mm59IC8gMiDiiaQgQiA8IM6yXnsybn0uXG4gKiAgbiBtdXN0IGJlIGV2ZW4uXG4gKlxuICogICAgICAgICAgICAgICAgICAgIC0tLS0tLS0tICAgICAgICAgICAgICAgICAtLS0tLVxuICogICAgICAgICAgICAgICAgICAgfCAgfCAgfCAgfCAgICAgICAgICAgICAgIHwgIHwgIHxcbiAqICAgICAgICAgICAgICAgICAgICAtLS0tLS0tLSAgICAgICAgICAgICAgICAgLS0tLS1cbiAqXG4gKiBPdXRwdXRcbiAqIC0tLS0tLVxuICogIFRoZSBxdW90aWVudCBmbG9vciggQS9CICkgYW5kIHRoZSByZW1haW5kZXIgQSBtb2QgQi5cbiAqXG4gKiBDb21wbGV4aXR5XG4gKiAtLS0tLS0tLS0tXG4gKiAgVCcobikg4omkIFQobikgKyBNKG4pICsgTG5cbiAqXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBfZGNfZGl2XzMyICggciAsIGEgLCBhaSAsIGFqICwgYiAsIGJpICwgYmogLCBjICwgY2kgLCBjaiApIHtcblxuXHQvLyAxLiBMZXQgQSA9IEFfMiDOsl57Mm59ICsgQV8xIM6yXm4gKyBBXzAgYW5kXG5cdC8vICAgIEIgPSBCXzEgzrJee259ICsgQl8wLFxuXHQvLyAgICB3aXRoIDAg4omkIEFfaSA8IM6yXm4gYW5kIDAg4omkIEJfaSA8IM6yXm4uXG5cblx0Y29uc3QgayA9IGJqIC0gYmkgO1xuXHRjb25zdCBuID0gayA+Pj4gMSA7XG5cblx0Ly8gMi4gSWYgQV8yIDwgQl8xLCBjb21wdXRlIFEgPSBmbG9vciggKCBBXzIgzrJebiArIEFfMSApIC8gQl8xICkgd2l0aFxuXHQvLyAgICByZW1haW5kZXIgUl8xIHVzaW5nIGFsZ29yaXRobSAzLjM7XG5cblx0aWYgKCBfbHQoIGEgLCBhaSAsIGFpICsgbiAsIGIgLCBiaSAsIGJpICsgbiApICkge1xuXHRcdF9kY19kaXZfMjEoIHIgLCBhICwgYWkgLCBhaiAtIG4gLCBiICwgYmkgLCBiaSArIG4gLCBjICwgY2kgKyBuICwgY2ogKSA7XG5cdH1cblxuXHQvLyAgICBvdGhlcndpc2UgbGV0IFEgPSDOsl5uIC0gMSwgYW5kIFJfMSA9ICggQV8yIC0gQl8xICkgzrJebiArIEFfMSArIEJfMVxuXHQvLyAgICAobm90ZSBpbiB0aGlzIGNhc2UgdGhhdCBBXzIgPSBCXzEpXG5cblx0ZWxzZSB7XG5cdFx0X2ZpbGwoIGMgLCBjaiAtIG4gLCBjaiAsIHIgLSAxICkgO1xuXHRcdF9pYWRkKCByICwgYSAsIGFpICwgYWogLSBuICwgYiAsIGJpICwgYmkgKyBuICApIDtcblx0XHRfaXN1YiggciAsIGEgLCBhaSAsIGFpICsgbiAsIGIgLCBiaSAsIGJpICsgbiAgKSA7XG5cdH1cblxuXHQvLyAzLiBSIDwtIFJfMSDOsl5uICsgQV8wIC0gUSpCXzBcblxuXHRjb25zdCB6aSA9IDAgO1xuXHRjb25zdCB6aiA9IG4gPDwgMSA7XG5cdGNvbnN0IHogPSBfemVyb3MoIHpqICkgO1xuXHRfbXVsKCByICwgYyAsIGNqIC0gbiAsIGNqICwgYiAsIGJpICsgbiAsIGJqICwgeiAsIHppICwgemogKSA7XG5cdF9pc3ViKCByICwgYSAsIGFpICwgYWogLCB6ICwgemkgLCB6aiApIDtcblxuXHQvLyA0LiBpZiBSIDwgMCAsIFIgPC0gUiArIEIgYW5kIFEgPC0gUSAtIDFcblxuXHRpZiAoIGFbYWldID09PSAwICkgcmV0dXJuIDtcblx0X2lhZGQoIHIgLCBhICwgYWkgLCBhaiAsIGIgLCBiaSAsIGJqICkgO1xuXHRfZGVjcmVtZW50KCByICwgYyAsIGNqIC0gbiAsIGNqICkgO1xuXG5cdC8vIDUuIGlmIFIgPCAwICwgUiA8LSBSICsgQiBhbmQgUSA8LSBRIC0gMVxuXG5cdGlmICggYVthaV0gPT09IDAgKSByZXR1cm4gO1xuXHRfaWFkZCggciAsIGEgLCBhaSAsIGFqICwgYiAsIGJpICwgYmogKSA7XG5cdF9kZWNyZW1lbnQoIHIgLCBjICwgY2ogLSBuICwgY2ogKSA7XG5cblx0Ly8gNi4gUmV0dXJuIFEgYW5kIFJcblxufVxuIl19