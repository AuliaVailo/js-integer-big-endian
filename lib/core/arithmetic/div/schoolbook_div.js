'use strict';

Object.defineProperty(exports, "__esModule", {
	value: true
});
exports.schoolbook_div = schoolbook_div;

var _array = require('../../array');

var _mul = require('../mul');

var _ = require('.');

/**
 * Computes q <- a / b and a <- a % b.
 * No leading zeros allowed.
 * q has length at least qi + aj - ai
 */
function schoolbook_div(r, a, ai, aj, b, bi, bj, q, qi) {

	var _r = Math.ceil(r / 2);
	var x = b[bi];

	if (x < _r) {

		// we need x to be >= _r so we multiply b by ceil( _r / x )
		// this gives us <= ( 1 + _r / x ) b < r^(bj-bi)
		// (this can be implemented faster using bit shifts if r = 2^k )
		var z = Math.ceil(_r / x);
		var m = aj - ai + 1;
		var n = bj - bi;

		var _a = (0, _array._zeros)(m);
		(0, _mul._mul_limb)(r, z, a, ai, aj, _a, 0, m);

		var _b = (0, _array._zeros)(n);
		(0, _mul._mul_limb)(r, z, b, bi, bj, _b, 0, n);

		var _q = (0, _array._zeros)(m);

		(0, _._schoolbook_div)(r, _a, 0, m, _b, 0, n, _q, 0);
		(0, _._div_limb_partial_fast)(r, _a[0], z, _a, 1, m, a, ai);
		(0, _array._copy)(_q, 1, m, q, qi);
		return;
	}

	return (0, _._schoolbook_div)(r, a, ai, aj, b, bi, bj, q, qi);
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9jb3JlL2FyaXRobWV0aWMvZGl2L3NjaG9vbGJvb2tfZGl2LmpzIl0sIm5hbWVzIjpbInNjaG9vbGJvb2tfZGl2IiwiciIsImEiLCJhaSIsImFqIiwiYiIsImJpIiwiYmoiLCJxIiwicWkiLCJfciIsIk1hdGgiLCJjZWlsIiwieCIsInoiLCJtIiwibiIsIl9hIiwiX2IiLCJfcSJdLCJtYXBwaW5ncyI6Ijs7Ozs7UUFTZ0JBLGMsR0FBQUEsYzs7QUFUaEI7O0FBQ0E7O0FBQ0E7O0FBRUE7Ozs7O0FBS08sU0FBU0EsY0FBVCxDQUEwQkMsQ0FBMUIsRUFBOEJDLENBQTlCLEVBQWtDQyxFQUFsQyxFQUF1Q0MsRUFBdkMsRUFBNENDLENBQTVDLEVBQWdEQyxFQUFoRCxFQUFxREMsRUFBckQsRUFBMERDLENBQTFELEVBQThEQyxFQUE5RCxFQUFtRTs7QUFFekUsS0FBTUMsS0FBS0MsS0FBS0MsSUFBTCxDQUFXWCxJQUFJLENBQWYsQ0FBWDtBQUNBLEtBQU1ZLElBQUlSLEVBQUVDLEVBQUYsQ0FBVjs7QUFFQSxLQUFLTyxJQUFJSCxFQUFULEVBQWM7O0FBRWI7QUFDQTtBQUNBO0FBQ0EsTUFBTUksSUFBSUgsS0FBS0MsSUFBTCxDQUFXRixLQUFLRyxDQUFoQixDQUFWO0FBQ0EsTUFBTUUsSUFBSVgsS0FBS0QsRUFBTCxHQUFVLENBQXBCO0FBQ0EsTUFBTWEsSUFBSVQsS0FBS0QsRUFBZjs7QUFFQSxNQUFNVyxLQUFLLG1CQUFRRixDQUFSLENBQVg7QUFDQSxzQkFBV2QsQ0FBWCxFQUFlYSxDQUFmLEVBQW1CWixDQUFuQixFQUF1QkMsRUFBdkIsRUFBNEJDLEVBQTVCLEVBQWlDYSxFQUFqQyxFQUFzQyxDQUF0QyxFQUEwQ0YsQ0FBMUM7O0FBRUEsTUFBTUcsS0FBSyxtQkFBUUYsQ0FBUixDQUFYO0FBQ0Esc0JBQVdmLENBQVgsRUFBZWEsQ0FBZixFQUFtQlQsQ0FBbkIsRUFBdUJDLEVBQXZCLEVBQTRCQyxFQUE1QixFQUFpQ1csRUFBakMsRUFBc0MsQ0FBdEMsRUFBMENGLENBQTFDOztBQUVBLE1BQU1HLEtBQUssbUJBQVFKLENBQVIsQ0FBWDs7QUFFQSx5QkFBaUJkLENBQWpCLEVBQXFCZ0IsRUFBckIsRUFBMEIsQ0FBMUIsRUFBOEJGLENBQTlCLEVBQWtDRyxFQUFsQyxFQUF1QyxDQUF2QyxFQUEyQ0YsQ0FBM0MsRUFBK0NHLEVBQS9DLEVBQW9ELENBQXBEO0FBQ0EsZ0NBQXdCbEIsQ0FBeEIsRUFBNEJnQixHQUFHLENBQUgsQ0FBNUIsRUFBb0NILENBQXBDLEVBQXdDRyxFQUF4QyxFQUE2QyxDQUE3QyxFQUFpREYsQ0FBakQsRUFBcURiLENBQXJELEVBQXlEQyxFQUF6RDtBQUNBLG9CQUFPZ0IsRUFBUCxFQUFZLENBQVosRUFBZ0JKLENBQWhCLEVBQW9CUCxDQUFwQixFQUF3QkMsRUFBeEI7QUFDQTtBQUVBOztBQUVELFFBQU8sdUJBQWlCUixDQUFqQixFQUFxQkMsQ0FBckIsRUFBeUJDLEVBQXpCLEVBQThCQyxFQUE5QixFQUFtQ0MsQ0FBbkMsRUFBdUNDLEVBQXZDLEVBQTRDQyxFQUE1QyxFQUFpREMsQ0FBakQsRUFBcURDLEVBQXJELENBQVA7QUFFQSIsImZpbGUiOiJzY2hvb2xib29rX2Rpdi5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IF96ZXJvcyAsIF9jb3B5IH0gZnJvbSAnLi4vLi4vYXJyYXknIDtcbmltcG9ydCB7IF9tdWxfbGltYiB9IGZyb20gJy4uL211bCcgO1xuaW1wb3J0IHsgX3NjaG9vbGJvb2tfZGl2ICwgX2Rpdl9saW1iX3BhcnRpYWxfZmFzdCB9IGZyb20gJy4nIDtcblxuLyoqXG4gKiBDb21wdXRlcyBxIDwtIGEgLyBiIGFuZCBhIDwtIGEgJSBiLlxuICogTm8gbGVhZGluZyB6ZXJvcyBhbGxvd2VkLlxuICogcSBoYXMgbGVuZ3RoIGF0IGxlYXN0IHFpICsgYWogLSBhaVxuICovXG5leHBvcnQgZnVuY3Rpb24gc2Nob29sYm9va19kaXYgKCByICwgYSAsIGFpICwgYWogLCBiICwgYmkgLCBiaiAsIHEgLCBxaSApIHtcblxuXHRjb25zdCBfciA9IE1hdGguY2VpbCggciAvIDIgKSA7XG5cdGNvbnN0IHggPSBiW2JpXSA7XG5cblx0aWYgKCB4IDwgX3IgKSB7XG5cblx0XHQvLyB3ZSBuZWVkIHggdG8gYmUgPj0gX3Igc28gd2UgbXVsdGlwbHkgYiBieSBjZWlsKCBfciAvIHggKVxuXHRcdC8vIHRoaXMgZ2l2ZXMgdXMgPD0gKCAxICsgX3IgLyB4ICkgYiA8IHJeKGJqLWJpKVxuXHRcdC8vICh0aGlzIGNhbiBiZSBpbXBsZW1lbnRlZCBmYXN0ZXIgdXNpbmcgYml0IHNoaWZ0cyBpZiByID0gMl5rIClcblx0XHRjb25zdCB6ID0gTWF0aC5jZWlsKCBfciAvIHggKSA7XG5cdFx0Y29uc3QgbSA9IGFqIC0gYWkgKyAxIDtcblx0XHRjb25zdCBuID0gYmogLSBiaSA7XG5cblx0XHRjb25zdCBfYSA9IF96ZXJvcyggbSApIDtcblx0XHRfbXVsX2xpbWIoIHIgLCB6ICwgYSAsIGFpICwgYWogLCBfYSAsIDAgLCBtICkgO1xuXG5cdFx0Y29uc3QgX2IgPSBfemVyb3MoIG4gKSA7XG5cdFx0X211bF9saW1iKCByICwgeiAsIGIgLCBiaSAsIGJqICwgX2IgLCAwICwgbiApIDtcblxuXHRcdGNvbnN0IF9xID0gX3plcm9zKCBtICkgO1xuXG5cdFx0X3NjaG9vbGJvb2tfZGl2KCByICwgX2EgLCAwICwgbSAsIF9iICwgMCAsIG4gLCBfcSAsIDAgKSA7XG5cdFx0X2Rpdl9saW1iX3BhcnRpYWxfZmFzdCggciAsIF9hWzBdICwgeiAsIF9hICwgMSAsIG0gLCBhICwgYWkgKSA7XG5cdFx0X2NvcHkoIF9xICwgMSAsIG0gLCBxICwgcWkgKSA7XG5cdFx0cmV0dXJuIDtcblxuXHR9XG5cblx0cmV0dXJuIF9zY2hvb2xib29rX2RpdiggciAsIGEgLCBhaSAsIGFqICwgYiAsIGJpICwgYmogLCBxICwgcWkgKSA7XG5cbn1cbiJdfQ==